



# 拒绝采样(Reject Sampling)

在数值分析(numerical analysis)和计算统计学(computational statistics)中，**拒绝采样**(rejection sampling)是一种用于从分布中生成观测值的基本技术。它也常被称为**接受-拒绝(acceptance-rejection)方法**或“接受-拒绝算法”，是一种精确模拟方法。该方法适用于任何具有密度的分布(distribution in ${\displaystyle \mathbb {R} ^{m}}$ with a density)。

拒绝采样的原理是基于这样的观察(observation)：在一维中采样一个随机变量(random variable)时，可以对二维笛卡尔图形(Cartesian graph)进行均匀随机采样，并保留图形密度函数曲线下的样本区域。这种性质可以扩展到 *N*-维函数。



为了形象地理解拒绝采样的动机，想象将随机变量的概率密度函数(PDF,Probability Density Function)绘制在一个大的矩形板上，并向其投掷飞镖。假设飞镖在板上均匀分布。现在移除所有落在曲线区域外的飞镖。剩下的飞镖将均匀分布在曲线下的区域内，而这些飞镖的位置将按照随机变量的密度分布。这是因为曲线最高处有最多的空间供飞镖落下，因此概率密度最大。

上述可视化描述等同于一种特定形式的拒绝采样，其中“提议分布(proposal distribution)”是均匀的，因此其图形是一个矩形。拒绝采样的通用形式假设板不一定呈矩形，而是根据提议分布的密度(不一定归一化为1)的形状。提议分布的形状必须在每个点上都高于目标分布，以便完全包含目标分布。否则，将有一些目标分布的区域永远无法到达。

拒绝采样工作原理如下：

1. 从提议分布中采样X轴上的一个点。
2. 在该位置处画一条垂直线，直到提议分布的概率密度函数的最大 y 值。
3. 沿此线从 0 到提议分布的概率密度函数的最大值均匀采样。如果采样值大于目标分布在该垂直线上的值，则拒绝该X值并返回步骤 1；否则，该X值即为目标分布的一个样本。

该算法可以用于采样任何曲线下的区域，无论该函数是否积分为 1。事实上，将函数按常数缩放不会影响采样的X位置。因此，该算法可以用于采样归一化常数未知的分布，这在计算统计学中很常见。



逆变换采样 Inverse transform sampling

累积分布函数 CDF，Cumulative Distribution Function